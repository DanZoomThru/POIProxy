
<!DOCTYPE html>

<html>

<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />

	<title>Leaflet Quick Start Guide Example</title>

	<meta charset="utf-8" />

	

	<link rel="stylesheet" href="../dist/leaflet.css" />

	<!--[if lte IE 8]><link rel="stylesheet" href="../dist/leaflet.ie.css" /><![endif]-->

</head>

<body>

	<div id="map"></div>


<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="../dist/leaflet.js"></script>

	<script>

		var map = new L.Map('map');

		

		var cloudmadeUrl = 'http://{s}.tile.cloudmade.com/BC9A493B41014CAABB98F0471D759707/997/256/{z}/{x}/{y}.png',

			cloudmadeAttribution = 'Map data &copy; 2011 OpenStreetMap contributors, Imagery &copy; 2011 CloudMade',

			cloudmade = new L.TileLayer(cloudmadeUrl, {maxZoom: 18, attribution: cloudmadeAttribution});

		

		map.addLayer(cloudmade);
        
            var tile = new L.TileLayer.TileJSON({
        debug: false,
        point: {
            color: 'rgba(252,146,114,0.6)',
            radius: 5
        },
        linestring: {
            color: 'rgba(161,217,155,0.8)',
            size: 3
        },
        polygon: {
            color: 'rgba(43,140,190,0.4)',
            outline: {
                color: 'rgb(0,0,0)',
                size: 1
            }
        }
    });

	    tile.createUrl = function (x, y, z) {
        var url = ['http://poiproxy.mapps.es/browse?service=panoramio&x=',x,'&y=',y,'&z=',z,'&callback=?'].join('');
        return url;
    };
    tile.styleFor = function (feature) {
        var type = feature.geometry.type;
        switch (type) {
            case 'Point':
            case 'MultiPoint':
                return {
                    color: 'rgba(252,146,114,0.6)',
                    radius: 5
                };
                
            case 'LineString':
            case 'MultiLineString':
                return {
                    color: 'rgba(161,217,155,0.8)',
                    size: 3
                };

            case 'Polygon':
            case 'MultiPolygon':
                return {
                    color: 'rgba(43,140,190,0.4)',
                    outline: {
                        color: 'rgb(0,0,0)',
                        size: 1
                    }
                };

            default:
                return null;
        }
    };
    //map.addLayer(tile);	
    var foursquare = new L.TileLayer.GeoJSON("http://poiproxy.mapps.es/browse?service=foursquare&x={x}&y={y}&z={z}&callback=?", {iconURL: "../dist/images/foursquare.png", service: "foursquare"});
    var panoramio = new L.TileLayer.GeoJSON("http://poiproxy.mapps.es/browse?service=panoramio&x={x}&y={y}&z={z}&callback=?", {iconURL: "../dist/images/panoramio.png", service: "panoramio"});
    var flickr = new L.TileLayer.GeoJSON("http://poiproxy.mapps.es/browse?service=flickr&x={x}&y={y}&z={z}&callback=?", {iconURL: "../dist/images/flickr.png", service: "flickr"});
    var minube = new L.TileLayer.GeoJSON("http://poiproxy.mapps.es/browse?service=minube&x={x}&y={y}&z={z}&callback=?", {iconURL: "../dist/images/minube.png", service: "minube"});
    var twitter = new L.TileLayer.GeoJSON("http://poiproxy.mapps.es/browse?service=twitter&x={x}&y={y}&z={z}&callback=?", {iconURL: "../dist/images/twitter.png", service: "twitter"});
map.addLayer(foursquare);

    
        var controlLayers = new L.Control.Layers({}, {"Foursquare": foursquare, "Panoramio": panoramio, "Flickr": flickr, "Minube": minube, "Twitter": twitter});
		map.addControl(controlLayers);
        map._controlLayers = controlLayers;

map.locateAndSetView(16);
map.on('locationfound', onLocationFound);
        
function onLocationFound(e) {
    var radius = e.accuracy / 2;

    var marker = new L.Marker(e.latlng);
    map.addLayer(marker);
    marker.bindPopup("You are within " + radius + " meters from this point").openPopup();
    
    var circle = new L.Circle(e.latlng, radius);
    map.addLayer(circle);	
}

		map.on('click', onMapClick);

		

		var popup = new L.Popup();

				

		function onMapClick(e) {

			var latlngStr = '(' + e.latlng.lat.toFixed(3) + ', ' + e.latlng.lng.toFixed(3) + ')';

			

			popup.setLatLng(e.latlng);

			popup.setContent("You clicked the map at " + latlngStr);

			map.openPopup(popup);

		}

	</script>

</body>

</html>
